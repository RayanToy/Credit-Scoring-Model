# Кредитный скоринг и прогнозирование дефолта клиентов

## О проекте

Данный проект представляет собой разработку и анализ скоринговой модели для прогнозирования вероятности дефолта клиента по кредиту (просрочка платежа на 60+ дней). Цель проекта — построить модель машинного обучения, которая эффективно разделяет клиентов на "надёжных" и "рискованных", и на основе этой модели рассчитать скоринговый балл для новых клиентов.

Работа включает в себя все ключевые этапы построения скоринговой карты: от предобработки данных и анализа признаков до сравнения и оптимизации различных моделей и финального прогноза.

## Структура проекта

*   `Анализ клиентов и прогнозирование его дефолта, кредитный скоринг.ipynb` — Jupyter Notebook со всем кодом исследования.
*   `Тест кандидата на вакансию в Отдел скоринговых систем.xls` — исходный файл с обучающими и тестовыми данными.
*   `requirements.txt` — список зависимостей для воспроизведения окружения.
*   `README.md` — данный файл.

## Методология и этапы работы

### 1. Предобработка данных

Основной акцент был сделан на подготовке данных, стандартной для задач кредитного скоринга:
*   **Кодирование категориальных признаков**: Для большинства моделей использовалось **Weight of Evidence (WOE)** кодирование. Этот метод преобразует категории в числовые значения, отражающие их "вклад" в вероятность дефолта, что улучшает интерпретируемость и производительность линейных моделей.
*   **Масштабирование числовых признаков**: Применялся `RobustScaler`, который устойчив к выбросам в данных, поскольку использует медиану и межквартильный размах.

### 2. Анализ влияния признаков

С помощью логистической регрессии был проведён анализ для выявления наиболее значимых факторов, влияющих на вероятность дефолта. Ключевыми предикторами оказались:
*   **Возраст**: С увеличением возраста вероятность дефолта снижается.
*   **Сумма кредита**: Более крупные кредиты связаны с более высоким риском.
*   **Образование, отрасль, иждивенцы**: Определённые категории этих признаков показали сильную связь с риском дефолта.
*   **Первый кредит**: Заёмщики, берущие кредит впервые, демонстрируют значительно более высокий риск.

### 3. Кластеризация клиентов

Для выявления скрытых сегментов в данных был применён метод кластеризации `K-Means`. На основе значимых признаков было выделено **3 основных кластера** клиентов, каждый со своим уникальным портретом:
*   **Кластер 0 ("Рискованные с крупными кредитами")**: Клиенты среднего возраста, берущие крупные суммы, с умеренно высоким риском дефолта.
*   **Кластер 1 ("Надёжные и зрелые")**: Клиенты старшего возраста, преимущественно женщины, берущие небольшие кредиты и имеющие самый низкий уровень дефолта.
*   **Кластер 2 ("Молодые и рискованные")**: Молодые заёмщики, берущие небольшие суммы, но с умеренно высоким риском дефолта.

### 4. Сравнение и оптимизация моделей

Для построения предиктивной модели были протестированы и сравнены следующие алгоритмы:
*   Логистическая регрессия
*   Линейный дискриминантный анализ (LDA)
*   Случайный лес (Random Forest)
*   XGBoost
*   CatBoost

Оптимизация гиперпараметров для каждой модели проводилась с помощью библиотеки **Optuna**, в качестве целевой метрики использовался **AUC-ROC** на 5-кратной кросс-валидации.

### 5. Результаты

Сравнение моделей по метрикам AUC-ROC и Gini на кросс-валидации и на отложенной тестовой выборке показало, что наилучшую предсказательную способность имеет модель **CatBoost**.

**Финальные метрики лучшей модели (CatBoost) на тестовой выборке:**
*   **AUC-ROC**: 0.78
*   **Gini**: 0.56
*   **F1-score**: 0.50 (при оптимальном пороге ~0.45)

Модель CatBoost продемонстрировала наилучший баланс между способностью к ранжированию клиентов (Gini) и точностью/полнотой классификации (F1-score).

## Как запустить проект

1.  **Клонируйте репозиторий.**
2.  **Создайте виртуальное окружение и установите зависимости:**
    ```bash
    pip install -r requirements.txt
    ```
3.  **Разместите файл с данными** `Тест кандидата на вакансию в Отдел скоринговых систем.xls` в той же директории, что и ноутбук.
4.  **Запустите Jupyter Notebook** и выполните ячейки.

Итоговые прогнозы для тестовой выборки, включая скоринговый балл, сохраняются в файл `Результаты прогнозирования CatBoost.xlsx`.
